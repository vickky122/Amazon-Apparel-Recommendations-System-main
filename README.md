# Amazon Apparel Recommendations System

![amazon](https://gitlab.com/akashbangalkar/amazon-apparel-recommendations-system/-/raw/main/amazon-apparel.jpg)

## Introduction
The rise of web services has made recommender systems an integral part of our lives. Recommender systems contribute significantly to the revenue generated by e-commerce sites such as Amazon and Flipkart. The Recommender System helps in suggesting the right content to the right user, thus helping in building a better user experience.

Recommender Systems are algorithms whose ultimate goal is to suggest content (movies, products) to the users. In many industries, the recommendations system plays a vital role.

We used Amazon’s Product Advertising API to obtain the data in a policy-complaint manner, and we acquired data for 1,83,000 products. For each product, we obtained many features like _Title, Brand, Color, Image-url, Price_ etc. For this case-study, we primarily focused on Women’s Apparel data. Amazon’s Product Advertising API can be used to extract data for other products as well.
## Business Objective
- Recommending similar items/products (apparel) to the given product (apparel) in any e-commerce websites based on Text and Image Features.
- Recommending similar apparel items to the user. It is estimated that Amazon’s 35% revenue is generated using product recommendations.

## Approach
- **Content Based Recommendation:** As its name suggests, we do content based recommendations, means it's based on Title text, Description text and Images.

## Plan of Attack
Following steps we followed during this case-study:
1. Data Aquisition
2. Data Cleaning
3. Text Processing (NLP)

We solve this problem with both Text-based and Image-based.<br>

**1. Text Based Product Recommendation/Similarity**
- Bag of Words<br>
_BoW is simple frequency counter, which gives more importance to a word that occurs more often in a given document._
- Term Frequency-Inverse Document Frequency (TF-IDF)<br>
_TFIDF is also sort of like a frequency counter, which gives more importance to a word that occurs less often in the whole document._

- Text Semantics Based Product Similarity<br>
_Semantic Similarity or Semantic Textual Similarity, is a task in the area of Natural Language Processing (NLP) that scores the relationship between texts or documents using a defined metric._<br>
_For eg. we know that the words 'tiger' and 'leopard' are related, also 'zebra' and 'strips' related._
  - Word2Vec - _Word2Vec is one such very popolar technique that learns meaningful relations and encodes the relatedness into vector similarity._
  - Avg W2V
  - IDF Weighted W2V<br>

- Weighted Similarity Using Brand & Color<br>
   - _In addition to title text, we can also use variables/parameters like Brand and Color. For each product it has Brand and Color, for this brand and color we will try to construct the seperate brand and color vectors using **One-Hot-Encoding technique**._<br>
   - _Once we construct these vectors, then we concatenate them with title vector._<br>

  _Let's assume, we want to prefer showing our customers the products of the same brand because probably some of them are brand conscious, OR If we want to pick or show products of the same color, then all we have to modify the Euclidean Distance, simply take Weighted Euclidean Distance._<br>
  _For that, we have to assign weights to each vector and simply multiply each elements of the vector with the assigned weights. After multiplying, just take the Euclidean Distance, which is extractedly similar to the Weighted Euclidean Distance in concept._<br>
    <br>_After doing this, what we get;<br>
    For Eg.<br>
    Weight for Title = 1<br>
    Weight for Brand = 5<br>
    Weight for Color = 1_<br><br>
    _In this case, since the brand weight is greater, we end up preferring products of the same brand. By just changing the weight, we can easily give our preference for the same brand or color._


**2. Image Based Product Recommendation/Similarity**<br>

  _There is one more very interesting parameter Product Image Url. For every product, we have a URL for product Image and with the help of URL we can download the product Image._<br>

  _Now the question is how to featurize an Image OR how to convert an Image to an n-dimensional vector ?_<br>

- Using CNN (Deep Learning Technique)<br>
   - _We can convert an Image to an n-dimensional vector using Deep Learning technique called **Convolutional Neural Network (CNN/ConvNets)**._<br>
   - _Since 2012, Google, Microsoft, Baidu, Nvidia, Facebook, Amazon and lots of companies & also some of universities like Oxford trained special ConvNets which works well._<br>
   - _There are multiple ConvNets like **AlexNets, VGG16, VGG19, ResNet** which used to convert an Image to an n-dimensional vector._<br>
   - _Training and desgining good ConvNets is very very expensive as it requires lots of hardwares, requires lots of expertise. If two Image are very similar then the euclidean distance between two vectors of Image is very small._<br>

  _There are multiple types of Convolutional Neural Network (CNN/ConvNets), as already mentioned above. We are going to use one of the very popolar ConvNet - **VGG16**._<br>
   - _**VGG16** (also called OxfordNet) is a Convolutional Neural Network architecture named after the **Visual Geometry Group** from **Oxford**, who developed it._<br>

  _Now to compute an n-dimensional vector from given Image, we will use two very popular libraries Keras and Tensorflow._
    - _**Tensorflow** is deep learning library which is designed and built at Google which is open source library._
    - _Similarly, **Keras** is also popular open source library which simplifies building CNNs and other types of Neural Networks very easily._

**3. Building Real World Solution**<br>
  - _We know multiple techniques such as BoW, TFIDF, Word2Vec, CNN, etc._<br>
  - _In reality, most companies/organizations or universities/institutes use multiple techniques. There is no single technique that always performs best._<br>
  - _Oftentimes all results are taken into consideration. We combine all of the results/algorithms and apply something called **Business Rules**._<br>
    - _Business rules could be; Do not show products of the same brand more than twice. We could have lots of business rules like this, which are dictated by business._<br>
    - _After applying business rules, we finally come up with a final result or list of recommendations. This final result or list that we get, is what we show to the customers._<br>
    - _So, In the real-world, in addition to the model, we have a bunch of business rules that dictate the quality of results._

**4. A/B Testing**<br>
  - _A/B Testing is methodology to measure how good our solution performs. A/B Testing is also called "Bucket Testing"_<br> 
    - _Let's assume, we built two solutions by combining multiple results/algorithms. Here, the solution --> **An algorithm along with business rules becomes a solution**, that we deploy._
    - _Now we have two solutions --> **Solution 1** and **Solution 2**._
    - _So, using **A/B Testing** we can evaluate which solution is better. Not subjectively, because different people could have different opinions._

    - _We will split users (from site) randomly into two groups --> **A** and **B**_
    - _Users in **Group A**, show them the result of Solution 1, and Users in **Group B**, show them the result of Solution 2._
    - _When we run our both solutions, then we can measure numerically the purchase and sales._
    - _Let's say if sales in Group A > sales in Group B, then we can say that the customers actually like Solution 1._
    - _i.e., Solution 1 is better than Solution 2 because after testing on users, they tend to prefer Solution 1_.
![A/B Testing](https://gitlab.com/akashbangalkar/amazon-apparel-recommendations-system/-/raw/main/ab_testing.png)

**Reference**<br>
  - Applied AI - https://www.appliedaicourse.com/
